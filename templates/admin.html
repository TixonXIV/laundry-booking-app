<<<<<<< HEAD
<!DOCTYPE html>
<html>
<head>
    <title>Админ панель</title>
</head>
<body>
    <h1>Админ панель</h1>
    <a href="{{ url_for('admin_logout') }}">Выйти</a>
    <br>
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul>
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}
    
    <!-- Сброс таблицы -->
    <form method="POST">
        <input type="hidden" name="action" value="reset">
        <input type="submit" value="Сбросить таблицу">
    </form>
    
    <!-- Заводской сброс -->
    <form method="POST">
        <input type="hidden" name="action" value="factory_reset">
        <input type="submit" value="Вернуть к заводским настройкам">
    </form>
    
    <!-- Экспорт в Word -->
    <form method="POST">
        <input type="hidden" name="action" value="export_word">
        <input type="submit" value="Экспорт в Word">
    </form>
    
    <!-- Добавление/редактирование/удаление временных слотов -->
    <h3>Управление временными слотами</h3>
    <p>Добавление нового слота: Введите формат HH:MM-HH:MM, он добавится для всех дней и машин в конец списка.</p>
    <form method="POST">
        <input type="hidden" name="action" value="add_time">
        <label>Новый слот:</label>
        <input type="text" name="new_time">
        <input type="submit" value="Добавить">
    </form>
    <form method="POST">
        <input type="hidden" name="action" value="edit_time">
        <label>Старый слот:</label>
        <select name="old_time">
            {% for ts in time_slots %}
                <option value="{{ ts }}">{{ ts }}</option>
            {% endfor %}
        </select>
        <label>Новый слот:</label>
        <input type="text" name="new_time">
        <input type="submit" value="Изменить">
    </form>
    <form method="POST">
        <input type="hidden" name="action" value="remove_time">
        <label>Удалить слот:</label>
        <select name="remove_time">
            {% for ts in time_slots %}
                <option value="{{ ts }}">{{ ts }}</option>
            {% endfor %}
        </select>
        <input type="submit" value="Удалить">
    </form>
    
    <!-- Управление днями -->
    <h3>Управление днями</h3>
    <form method="POST">
        <input type="hidden" name="action" value="add_day">
        <label>Новый день:</label>
        <input type="text" name="new_day">
        <input type="submit" value="Добавить">
    </form>
    <form method="POST">
        <input type="hidden" name="action" value="edit_day">
        <label>Старый день:</label>
        <select name="old_day">
            {% for day in days %}
                <option value="{{ day }}">{{ day }}</option>
            {% endfor %}
        </select>
        <label>Новый день:</label>
        <input type="text" name="new_day">
        <input type="submit" value="Изменить">
    </form>
    <form method="POST">
        <input type="hidden" name="action" value="remove_day">
        <label>Удалить день:</label>
        <select name="remove_day">
            {% for day in days %}
                <option value="{{ day }}">{{ day }}</option>
            {% endfor %}
        </select>
        <input type="submit" value="Удалить">
    </form>
    
    <!-- Управление машинами -->
    <h3>Управление машинами</h3>
    <form method="POST">
        <input type="hidden" name="action" value="add_machine">
        <input type="submit" value="Добавить новую машину">
    </form>
    {% for machine in machines %}
        <form method="POST" style="display:inline;">
            <input type="hidden" name="action" value="toggle_machine">
            <input type="hidden" name="machine_num" value="{{ machine }}">
            <input type="submit" value="Отключить/Включить машину {{ machine }}">
        </form>
        <form method="POST" style="display:inline;">
            <input type="hidden" name="action" value="remove_machine">
            <input type="hidden" name="remove_machine" value="{{ machine }}">
            <input type="submit" value="Удалить машину {{ machine }}">
        </form>
    {% endfor %}
    
    <!-- Редактирование таблицы -->
    {% for day in days %}
        <h2>{{ day }}</h2>
        <table border="1">
            <tr>
                <th>Время</th>
                {% for machine in machines %}
                    <th>Машина {{ machine }}</th>
                {% endfor %}
            </tr>
            {% for ts in time_slots %}
                <tr>
                    <td>{{ ts }}</td>
                    {% for idx in range(machines|length) %}
                        <td>
                            <form method="POST">
                                <input type="hidden" name="action" value="edit">
                                <input type="hidden" name="day" value="{{ day }}">
                                <input type="hidden" name="time_slot" value="{{ ts }}">
                                <input type="hidden" name="machine" value="{{ machines[idx] }}">
                                <input type="text" name="new_value" value="{% if schedule_data[day][ts][idx] and schedule_data[day][ts][idx] != 'Отключена' %}{{ schedule_data[day][ts][idx] }}{% endif %}" placeholder="Фамилия Комната" {% if schedule_data[day][ts][idx] == 'Отключена' %}disabled{% endif %}>
                                <input type="submit" value="Сохранить" {% if schedule_data[day][ts][idx] == 'Отключена' %}disabled{% endif %}>
                            </form>
                        </td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    {% endfor %}
=======
<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Админ панель</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; font-family: Arial, sans-serif; }
        .navbar { background-color: #28a745; }
        .card { margin-bottom: 20px; }
        .btn-add { background-color: #28a745; border: none; }
        .btn-edit { background-color: #ffc107; border: none; }
        .btn-remove { background-color: #dc3545; border: none; }
        .table { margin-top: 20px; }
        .disabled-cell { background-color: #e9ecef; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Админ панель</a>
            <div class="ms-auto">
                <a href="{{ url_for('admin_logout') }}" class="btn btn-outline-light">Выйти</a>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class="alert alert-info">
                    <ul class="mb-0">
                        {% for message in messages %}
                            <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        {% endwith %}
        
        <div class="row">
            <!-- Сброс таблицы -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Сброс таблицы</h5>
                        <form method="POST">
                            <input type="hidden" name="action" value="reset">
                            <button type="submit" class="btn btn-warning w-100">Сбросить таблицу</button>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Заводской сброс -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Заводской сброс</h5>
                        <form method="POST">
                            <input type="hidden" name="action" value="factory_reset">
                            <button type="submit" class="btn btn-danger w-100">Вернуть к заводским настройкам</button>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Экспорт в Word -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Экспорт в Word</h5>
                        <form method="POST">
                            <input type="hidden" name="action" value="export_word">
                            <button type="submit" class="btn btn-primary w-100">Экспорт в Word</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Управление временными слотами -->
        <div class="card">
            <div class="card-header">
                <h5>Управление временными слотами</h5>
            </div>
            <div class="card-body">
                <p>Добавление нового слота: Введите формат HH:MM-HH:MM, он добавится для всех дней и машин в конец списка.</p>
                <form method="POST" class="row g-3 mb-3">
                    <input type="hidden" name="action" value="add_time">
                    <div class="col-auto">
                        <label class="form-label">Новый слот:</label>
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" name="new_time">
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-add">Добавить</button>
                    </div>
                </form>
                <form method="POST" class="row g-3 mb-3">
                    <input type="hidden" name="action" value="edit_time">
                    <div class="col-auto">
                        <label class="form-label">Старый слот:</label>
                    </div>
                    <div class="col">
                        <select class="form-select" name="old_time">
                            {% for ts in time_slots %}
                                <option value="{{ ts }}">{{ ts }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-auto">
                        <label class="form-label">Новый слот:</label>
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" name="new_time">
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-edit">Изменить</button>
                    </div>
                </form>
                <form method="POST" class="row g-3">
                    <input type="hidden" name="action" value="remove_time">
                    <div class="col-auto">
                        <label class="form-label">Удалить слот:</label>
                    </div>
                    <div class="col">
                        <select class="form-select" name="remove_time">
                            {% for ts in time_slots %}
                                <option value="{{ ts }}">{{ ts }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-remove">Удалить</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Управление днями -->
        <div class="card">
            <div class="card-header">
                <h5>Управление днями</h5>
            </div>
            <div class="card-body">
                <form method="POST" class="row g-3 mb-3">
                    <input type="hidden" name="action" value="add_day">
                    <div class="col-auto">
                        <label class="form-label">Новый день:</label>
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" name="new_day">
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-add">Добавить</button>
                    </div>
                </form>
                <form method="POST" class="row g-3 mb-3">
                    <input type="hidden" name="action" value="edit_day">
                    <div class="col-auto">
                        <label class="form-label">Старый день:</label>
                    </div>
                    <div class="col">
                        <select class="form-select" name="old_day">
                            {% for day in days %}
                                <option value="{{ day }}">{{ day }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-auto">
                        <label class="form-label">Новый день:</label>
                    </div>
                    <div class="col">
                        <input type="text" class="form-control" name="new_day">
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-edit">Изменить</button>
                    </div>
                </form>
                <form method="POST" class="row g-3">
                    <input type="hidden" name="action" value="remove_day">
                    <div class="col-auto">
                        <label class="form-label">Удалить день:</label>
                    </div>
                    <div class="col">
                        <select class="form-select" name="remove_day">
                            {% for day in days %}
                                <option value="{{ day }}">{{ day }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-remove">Удалить</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Управление машинами -->
        <div class="card">
            <div class="card-header">
                <h5>Управление машинами</h5>
            </div>
            <div class="card-body">
                <form method="POST" class="mb-3">
                    <input type="hidden" name="action" value="add_machine">
                    <button type="submit" class="btn btn-add w-100">Добавить новую машину</button>
                </form>
                <div class="row">
                    {% for machine in machines %}
                        <div class="col-md-4 mb-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <h6>Машина {{ machine }}</h6>
                                    <form method="POST" class="d-inline">
                                        <input type="hidden" name="action" value="toggle_machine">
                                        <input type="hidden" name="machine_num" value="{{ machine }}">
                                        <button type="submit" class="btn btn-secondary">Отключить/Включить</button>
                                    </form>
                                    <form method="POST" class="d-inline">
                                        <input type="hidden" name="action" value="remove_machine">
                                        <input type="hidden" name="remove_machine" value="{{ machine }}">
                                        <button type="submit" class="btn btn-remove">Удалить</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <!-- Редактирование таблицы -->
        {% for day in days %}
            <div class="card mb-4">
                <div class="card-header">
                    <h5>{{ day }}</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Время</th>
                                    {% for machine in machines %}
                                        <th>Машина {{ machine }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            <tbody>
                                {% for ts in time_slots %}
                                    <tr>
                                        <td>{{ ts }}</td>
                                        {% for idx in range(machines|length) %}
                                            <td {% if schedule_data[day][ts][idx] == 'Отключена' %}class="disabled-cell"{% endif %}>
                                                <form method="POST" class="d-flex">
                                                    <input type="hidden" name="action" value="edit">
                                                    <input type="hidden" name="day" value="{{ day }}">
                                                    <input type="hidden" name="time_slot" value="{{ ts }}">
                                                    <input type="hidden" name="machine" value="{{ machines[idx] }}">
                                                    <input type="text" class="form-control me-2" name="new_value" value="{% if schedule_data[day][ts][idx] and schedule_data[day][ts][idx] != 'Отключена' %}{{ schedule_data[day][ts][idx] }}{% endif %}" placeholder="Фамилия Комната" {% if schedule_data[day][ts][idx] == 'Отключена' %}disabled{% endif %}>
                                                    <button type="submit" class="btn btn-primary" {% if schedule_data[day][ts][idx] == 'Отключена' %}disabled{% endif %}>+</button>
                                                </form>
                                            </td>
                                        {% endfor %}
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
>>>>>>> 2b51751 (Initial commit)
</body>
</html>